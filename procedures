DELIMITER $$

CREATE PROCEDURE GetSentenceExamples (IN SearchedWord VARCHAR(50))
AS 
BEGIN
	SELECT SENTENCES.body, ARTICLES.article_url FROM SENTENCES 
	JOIN SENTENCES_ARTICLES ON SENTENCES.sentence_id = SENTENCES_ARTICLES.sentence_id 
	JOIN ARTICLES ON SENTENCES_ARTICLES.article_id = ARTICLES.article_id 
	JOIN WORD_SENTENCES on SENTENCES.sentence_id = WORD_SENTENCES.sentence_id
	JOIN WORDS on WORDS.word_id = WORD_SENTENCES.word_id
	WHERE WORDS.body = SearchedWord
	ORDER BY RAND()
	LIMIT 10;
END

DELIMITER ;

DELIMITER $$

CREATE PROCEDURE GetClientPreferences (IN ClientIDTelegram INT)
BEGIN
	SELECT GENRE.body, LANGUAGES.body, THEME.body FROM GENRE
	JOIN CLIENT_SOURCEGENRE ON GENRE.sgenre_id = CLIENT_SOURCEGENRE.sgenre_id
	JOIN CLIENT ON CLIENT_SOURCEGENRE.client_id = CLIENT.client_id
	JOIN CLIENT_LANGUAGES ON CLIENT.client_id = CLIENT_LANGUAGES.client_id
	JOIN LANGUAGES ON CLIENT_LANGUAGES.language_id = LANGUAGES.language_id
	JOIN CLIENT_THEME ON CLIENT.client_id = CLIENT_THEME.client_id
	JOIN THEME ON CLIENT_THEME.theme_id = CLIENT.theme_id
	WHERE CLIENT.client_id = ClientIDTelegram;
END $$

DELIMITER ;

DELIMITER $$

CREATE PROCEDURE GetSearchHistory (IN ClientIDTelegram INT)
BEGIN
	SELECT WORDS.body FROM WORDS
	JOIN CLIENT_WORDS ON WORDS.word_id = CLIENT_WORDS.word_id
	JOIN CLIENT ON CLIENT_WORDS.client_id = CLIENT.client_id
	WHERE CLIENT.client_id = ClientIDTelegram
	LIMIT 10;
END $$

DELIMITER ;
